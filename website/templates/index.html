<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RTSP Camera Stream Viewer</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>RTSP Camera Stream Viewer</h1>

    <div>
        <label for="cameraSelect">Select Camera:</label>
        <select id="cameraSelect">
            <option value="camera1">Camera 1</option>
            <option value="camera2">Camera 2</option>
        </select>
    </div>

    <div>
        <img id="videoStream" src="" alt="RTSP Stream">
    </div>

    <script>
        $(document).ready(function() {
            var currentCamera = "camera1";
            // Function to update the video stream based on the selected camera
            function updateVideoStream(camera) {
                $("#videoStream").attr("src", "/video_feed?camera=" + camera);
            }

            // Initialize with the default camera (e.g., camera1)
            updateVideoStream(currentCamera);

            // Handle camera selection change
            $("#cameraSelect").change(function() {
                var selectedCamera = $(this).val();
                updateVideoStream(selectedCamera);
                $.get("/disconnect?camera=" + currentCamera);
                currentCamera = selectedCamera;
            });

            // Handle page unload or tab close
            $(window).on('beforeunload', function() {
                var selectedCamera = $("#cameraSelect").val();
                if (selectedCamera) {
                    $.get("/disconnect?camera=" + selectedCamera);
                }
            });
        });
    </script>
</body>
</html>
